<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="myComment">

	<!--내가 작성한 댓글 조회 -->
	<select id="myCommentSelect" resultType="CommentListDTO">
	<![CDATA[
	SELECT * FROM (
	SELECT ROWNUM AS RNUM, SUBQUERY.*
		FROM (
			SELECT  
					p.POST_NUMBER AS postNumber,
			    P.POST_TYPE AS postType,
			    P.POST_TITLE AS postTitle,
			    (SELECT m.MEMBER_ID FROM TBL_MEMBER m WHERE p.MEMBER_NUMBER = m.MEMBER_NUMBER ) AS memberId,							
			    C.COMMENT_CONTENT AS commentContent,
			    TO_CHAR(C.COMMENTED_DATE, 'YYYY-MM-DD') AS commentedDate
			FROM TBL_POST P
			INNER JOIN TBL_COMMENT C ON P.POST_NUMBER = C.POST_NUMBER
			WHERE C.COMMENT_DELETE_STATE = 'N'
			AND C.MEMBER_NUMBER = #{memberNumber}
	   ) SUBQUERY
	 )
	]]>
	</select>

	<!-- 내가 작성한 댓글 조회 -->
	<select id="myCommentCount" resultType="int">
		<![CDATA[
		SELECT count(P.POST_TITLE )
		FROM TBL_POST P
		INNER JOIN TBL_COMMENT C ON P.POST_NUMBER = C.POST_NUMBER
		WHERE C.COMMENT_DELETE_STATE = 'N'
		AND C.MEMBER_NUMBER = #{memberNumber}
		]]>
	</select>

</mapper>